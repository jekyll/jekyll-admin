environment:
  nodejs_version: "6"
  RACK_ENV: test
  JEKYLL_LOG_LEVEL: warn
  matrix:
    - RUBY_FOLDER_VER: "22"
      GEMS_FOLDER_VER: "2.2.0"
    - TEST_SUITE: node
    - TEST_SUITE: ruby

install:
  - set PATH=C:\Ruby%RUBY_FOLDER_VER%\bin;%PATH%
  - ps: Install-Product node $env:nodejs_version
  - gem install bundler --no-ri --no-rdoc
  - bundle config --local path vendor/bundle
  - sh script/bootstrap

build: off

before_test:
  - node --version
  - npm --version
  - ruby -v
  - gem -v
  - bundle -v

test_script:
  - sh script/cibuild

cache:
  - vendor/bundle
  - node_modules
  # If one of the files after the right arrow changes, cache will be skipped
  - C:\Ruby%RUBY_FOLDER_VER%\bin -> Gemfile,jekyll-admin.gemspec,appveyor.yml
  - C:\Ruby%RUBY_FOLDER_VER%\lib\ruby\gems\%GEMS_FOLDER_VER% -> Gemfile,jekyll-admin.gemspec,appveyor.yml

init:
  - git config --global core.autocrlf true
